[![基于 VS Code + MinGW-w64 的C语言/C++简单环境配置，专致小白](https://raw.githubusercontent.com/wefashe/git-images/master/images/20200614112851.jpg)](https://zhuanlan.zhihu.com/p/77074009)


# 基于 VS Code + MinGW-w64 的C语言/C++简单环境配置，专致小白

[![追远·J](https://pic4.zhimg.com/v2-793ddf17d6c7888ed8e2fafea9fd3cc1_xs.jpg)](https://www.zhihu.com/people/zhui-yuan-j)

[追远·J](https://www.zhihu.com/people/zhui-yuan-j)

物理学 / 计算机

354 人赞同了该文章

> 写在前面。本文是**小白启蒙文**，但并不能保证每词每句都极度通俗，仍然**有些专业概念因限于篇幅不能详解**，作者尽力将**可参阅资料的链接**插入其中。本文注重**操作性**，尤其希望还未能建立起完整编程理念的同学们**精读细读、逐步实操**，避免遗漏步骤或操作错误。细节在编程这项活计中极具影响力，小白因背景知识薄弱而经常踩坑实属难免，但**错误也是学习的重要途经**，学会从错误中反省与学习是非常优秀的品质，与诸君共勉。

——————正文分割线——————

> 作者初学C语言时选择的是Visual Studio (即VS)。其功能之完整强大无愧为宇宙第一IDE (集成开发环境)，但对新手来说，它一是硬盘占用太多，二是预配置过于完善，为小白填平了不少新手坑的同时，也掩盖了很多有必要学习和了解的知识点。本文将回归**文本编辑器+编译器**这一经典本源，省去VS的诸多高级的库和调试工具，最重要的是从中**理解编程的本质（代码→编译→链接→执行）**。（如果你仍有意于使用VS，可参阅[追远·J：2019年的C语言初学者](https://zhuanlan.zhihu.com/p/71110525)一文）

目录：

- 安装MinGW-w64编译器套件
- 安装VS Code文本编辑器
- 配置C/C++环境
- 编写"Hello World"程序

## 安装MinGW-w64编译器套件

要编写C/C++这样的静态语言程序，**必备工具**是一套可用的**编译器**。

> 编译器：它是能**将你的源代码翻译成计算机可直接执行的程序文件**（Windows上即.exe文件）的**程序**。高级程序语言的一大特点是代码具有跨平台性，但不同的硬件和操作系统底层可直接执行的指令显然各不相同呀，这就决定了我们需要不同的编译器。

本文提到的**MinGW-w64**是一个著名项目为**Windows 64位**平台提供的一套编译器，它也**受到了微软官方文档的推荐**，相关文件托管在SourceForge的网站上，下载地址为

[MinGW-w64 - for 32 and 64 bit Windowssourceforge.net](https://link.zhihu.com/?target=https%3A//sourceforge.net/projects/mingw-w64/files/)

**翻到下面**，找到我们需要的编译器套件（其中x86_64代表64位，win32代表Windows平台，seh不管，选它就对了），

> 至于Linux和Mac，作者限于目前的水平还不能给出详尽的方案，但它们安装编译器应该都比Windows方便才是。

![img](https://pic4.zhimg.com/80/v2-9a8d41ccc5c8dddec7fde3bf63a05827_1440w.jpg)

下载下来是个几十MB的压缩文件，后缀名为".7z"，需要支持该格式的压缩软件进行解压。

> 个人习惯的解压缩软件是Bandizip，下载地址[https://www.bandisoft.com/bandizip/](https://link.zhihu.com/?target=https%3A//www.bandisoft.com/bandizip/)，它清爽不流氓，可以解压缩包括7z在内的许多压缩文件。

压缩文件内是一个名为mingw64的单文件夹，**建议把它解压到某盘根目录下**。如果你听我的，就是下面这样；如果你不听，请务必将其放到**某个不包含空格且尽可能短的目录**下。

![img](https://pic4.zhimg.com/80/v2-0f758dcac77d2a8a16358669d1567fe7_1440w.jpg)

定向解压免去搬运文件夹的麻烦。此时，我所有的编译器组件就都安放好了，请注意其中**bin文件夹**是我们实际要用的编译器所在的位置，其他文件夹是这套编译器的相关资源请勿乱动。

![img](https://pic2.zhimg.com/80/v2-850d19b9ddd438439f9fed9f289ba461_1440w.jpg)

打开bin文件夹你可以看到很多应用程序，其中就有**gcc**、**g++**等著名的编译器。

![img](https://pic3.zhimg.com/80/v2-539f00907f550a12d08eacc2cb0dd5aa_1440w.jpg)

接下来，**为使外部程序或用户（也就是你）能访问到这些编译器**，需要把它们所在的目录（我这里就是`C:\mingw64\bin\`）添加到环境变量Path中。按快捷键【Windows徽标】+【S】打开Win10搜索框，输入“环境变量”，应该会弹出两个匹配结果，选择“编辑**账户**的环境变量”（两个匹配项很相似别点错了！之所以选它是防止你误改系统变量损害系统），

![img](https://pic2.zhimg.com/80/v2-84e11c489636405fb0b99cd697fb4371_1440w.jpg)

点击上面的用户变量Path，选择“编辑”，或者直接双击（不要去动下面的系统变量！）

![img](https://pic3.zhimg.com/80/v2-ce3ca7153eeb819eb17e891d18fcc2aa_1440w.jpg)

然后**点击下方空白处**，把刚才那堆应用程序所在的目录（我的是`C:\mingw64\bin\`）添加进去（一定要添加在下面，**不要覆盖已有内容**，除非你清楚它没有用），**注意结尾是bin，别输错了**；或者选择“浏览”找到bin文件夹，然后一路确定退出。

![img](https://pic1.zhimg.com/80/v2-bdbbaa74fc91158385039b52f5443970_1440w.jpg)

如果你看到的编辑界面是这种非常狭小的框，说明你系统有点老。不过没关系，添加路径的道理是一样的，只是**注意先把光标拖对位置**！当然我这里已经输入过了。

![img](https://pic2.zhimg.com/80/v2-24ef620e2749e968e62839acea4d0b19_1440w.jpg)

请使用**英文输入法**、在取消蓝色选中状态后、在末尾添加内容`**;**<你的路径>`，千万别清除你所有原来的变量值！

最后为了验证之前操作是否正确，我们需要实际访问一下那些编译器。还是在搜索框中，输入“cmd”，启动“命令提示符”，在命令窗口中输入以下命令并回车

```text
gcc --version
```

如果结果如图所示，你的编译器就安装成功了。如果失败，请回头检查你添加的路径是否生效且与实际相符；或者请卸载你参考其他教程安装的老式MinGW编译器并清除其添加在Path中的路径。

![img](https://pic4.zhimg.com/80/v2-32709a4fd8e25df73e146a1f5ef9792f_1440w.jpg)

## 安装Visual Studio Code文本编辑器

文本编辑器是写代码的**辅助工具**，它原则上不是必需品，也不为特定编程语言服务。原则上只要是能编写**纯文本文件**的软件（最简单如Windows记事本），都可以编写**任何语言**的代码。但考虑到实际的编程体验，众多专用的编辑器被开发出来，以提供**代码高亮**（根据特定语言的语法给代码染色，便于阅读）、**语法错误检查**（在编译前提示错字漏字、不合规的语句等错误）、**多文件的管理**等辅助功能。

这里提到的Visual Studio Code (即VS Code)，仅仅是本文的示例，下载地址为

[Visual Studio Code - Code Editing. Redefinedcode.visualstudio.com![图标](https://pic2.zhimg.com/v2-61c3a2267730366dc298de64df0e08c1_180x120.jpg)](https://link.zhihu.com/?target=https%3A//code.visualstudio.com/)

> 注意VS Code跟VS (Visual Studio)只是同属一家、名称相近，但不是一类软件别搞错了。

根据你的平台选择适合的版本，下载下来安装即可。安装完打开大概是这样的，

![img](https://pic4.zhimg.com/80/v2-40035dd7a9fb989c1d1373d6f2f17617_1440w.jpg)

> 界面左侧5个大按钮点击可以展开或折叠相应的侧边栏，鼠标悬停可以显示其名称和快捷键。

初始启动页应该是英文，如果需要中文，点击左侧第5个按钮“插件管理器”，在搜索栏中输入"Chinese"，找到汉化插件，安装即可。

![img](https://pic2.zhimg.com/80/v2-92b3d5361dc5b06545efce75800d4b6d_1440w.jpg)

安装完后，由于我们需要配置C/C++环境，所以请再次**搜索"C/C++"，安装这个插件**。

![img](https://pic3.zhimg.com/80/v2-d24a5c569998ece8fbd5e43f7f751286_1440w.jpg)

全部安装完毕**重启VS Code**。VS Code本身及其插件常常会自动更新，更新完后也往往需要重启软件以使更改生效。

## 配置C/C++的简单环境（重启VS Code后进行！）

这里实际上就是VS Code的简单用法，几个基本点有必要提及一下：

1. 脑子里要有**源代码文件**这个概念。写程序不是说就在框框里写一堆代码然后就能跑了！代码都要**写成文件保存起来（到硬盘里）**，然后才有后续的工作；
2. VS Code是支持多语言的编辑器，并不只为C/C++服务，所以还要**确保把代码文件的后缀名写对**，C语言的后缀名是`.c`，C++的是`.cpp`。这是VS Code区分你代码类型的标志；
3. 上面安装的"C/C++"插件提供了对这两门语言的基本支持。C跟C++是**两门不同的语言**，请**向你的老师问清楚学的是哪一门**。无论是在.c文件里敲C++代码，还是在.cpp文件里敲C代码，都是XX的行为。
4. 编写C/C++程序有两个基本步骤，一是把代码文件变成程序文件，这叫**编译**或**生成**，是编译器做的事；二才是把刚刚生成的程序跑起来，这叫**执行**，是操作系统做的事；
5. 代码的编译和一般程序的执行，都是在**命令行**的环境下进行的，输入输出也是在这里面。VS Code的优势之一，就是把系统的命令行集成进了软件内部，名唤“**终端**”，从而不必再开新窗口。

请务必认真仔细阅读并充分理解以上几条内容，**如果不解请留个心眼**，在下面遇到问题后回来看看。

进入正题，在VS Code中编写C/C++程序，应该**先打开一个文件夹**，创建一个**工作区**。倒不是说它不能直接打开单文件，打开文件夹工作的好处包括

- **一个文件夹下包含你一个项目或一段时期内的各种文件**，便于我们分门别类、有序地组织代码；
- **一个文件夹内可以保存独立的配置**（在其子目录`.vscode`中保存配置文件，能随工作文件夹一起移动），仅在这个区域内覆盖而不修改用户个人的全局配置，也不会与其他工作区的配置相冲突；
- **VS Code的集成终端在工作区内自动以该文件夹为启动目录**，这样在里面编译和执行程序时可以方便地使用**相对路径**。

> **路径**是对计算机中文件和文件夹的指示，是编译和执行程序的**必备基础知识**，如有疑问请参阅以下扫盲贴，

[追远·J：基于Windows的 命令行 与 文件路径 扫盲zhuanlan.zhihu.com![图标](https://pic2.zhimg.com/zhihu-card-default_ipico.jpg)](https://zhuanlan.zhihu.com/p/85455028)

具体操作为，选择左侧“资源管理器”（第一个长得像纸页的图标）后按下图操作，或者选择菜单项【文件】→【打开文件夹…】，

![img](https://pic1.zhimg.com/80/v2-277b2df90c4ec4b79fcb3351f4cea084_1440w.jpg)

来找到一个你觉得合适的文件夹，打开后你的侧边栏会变成这样

![img](https://pic2.zhimg.com/80/v2-647e64e76cfb24f403834e52b730c7dd_1440w.jpg)

“资源管理器”侧边栏由上至下分别是“打开的编辑器”“工作文件夹名”“大纲”，**通过左侧的小三角`>`都可以展开或折叠**。在这里能方便地进行新建、移动、复制、删除文件或文件夹等基本操作。

接下来，是要利用"C/C++"插件预定义好了的配置，稍作修改以满足我们的需要。按快捷键【Ctrl】【Shift】+【P】，打开命令面板，输入关键词"C/C++"，在弹出的诸命令中选择**编辑配置 (UI)**或者**Edit Configurations (UI)**，将弹出"C/C++"给我们的默认配置（JSON那个操作难度较大，有兴趣的可自行研究）。

![img](https://pic2.zhimg.com/80/v2-dde7df5b0c49ec65845c96612f1d1205_1440w.jpg)

![img](https://pic3.zhimg.com/80/v2-1a937b0b05f85b59ae0841ade3636b96_1440w.jpg)

诸配置中最重要的是**编译器路径**和**IntelliSense模式**这两项，两者在右侧都有下拉三角。如果前面你正确配置了环境变量，路径的待选项中就会包含几个正确的编译器路径，**编写C程序请选择gcc.exe，C++则选择g++.exe**；模式选择**gcc-x64**。

> 配置完成后你可以看到一个`c_cpp_properties.json`文件保存在了`.vscode`子目录中，它在你这个工作文件夹中生效。如果你使用一个新的工作文件夹，就重新配置一下。

![img](https://pic2.zhimg.com/80/v2-ccd7148c1fd2ecfbf3935916b06dc915_1440w.jpg)

至此配置工作已基本完成，具体的用法，按国际惯例演示。

## 编写"Hello World"程序

到工作文件夹中添加一个源代码文件，命名为hello**.c**（或者任意你喜欢的名字，但注意后缀名.c别忘了打上），

> 我这里的示例是C语言的，要试用C++的请注意后缀名为.cpp，并求教你的老师或自行编写相应代码。

![img](https://pic2.zhimg.com/80/v2-1b01fde68ecd82c689f4b7d0e82f390d_1440w.jpg)

输完你的代码后，

### **保**存、

### 保存、

### 保存！

快捷键【Ctrl】+【S】包含了多少血泪的教训我就不多说了。这里的问题主要是**编译器需要从硬盘中读取你的代码文件**，而未保存的代码在硬盘上是未更新的甚至压根不存在，将直接导致接下来的编译掰瞎！这么多提醒你文件没保存的标记要是都看不到就尴尬了。

![img](https://pic1.zhimg.com/80/v2-c11b34e5dc5fa4b245b2a8686e580b40_1440w.jpg)

保存后按快捷键【Ctrl】+【`】（主键盘区左上角Esc键下面那个）即可打开嵌入式终端（命令行环境），**编译代码的命令**为

```text
gcc˽-o˽目标文件路径˽源代码文件路径
```

我用符号`˽`标记了空格，“目标文件”即你要生成的程序文件，起名和加不加.exe都随意（因为它会自动加）。在我们这，由于已经在工作区里，可以使用相对路径，

```text
gcc -o .\myhello .\hello.c
```

回车，就能编译你刚刚的hello.c文件，如果成功，则在相同目录下生成一个myhello.exe程序文件。**执行程序**的命令为

```text
程序文件路径
```

是的形式上就是这样，只是路径可以是绝对或相对的，当然相对的一般更方便，这里要执行上面的程序就是

```text
.\myhello.exe
```

注意VS Code的默认终端实际上是**PowerShell，需要使用`.\`显式地指明它是当前目录下的可执行文件**，如果省略它出于安全原因会拒绝你程序的执行。

要是你的“Hello World”输出成功，恭喜你使用VS Code编写C的第一步已经成功。VS Code还包含许多其他有用功能，包括更人性化的断点调试、单步调试、变量监测等，可能需要进一步配置才可用，可自行探索，或参阅微软官方文档

[https://code.visualstudio.com/docs/cpp/cpp-debugcode.visualstudio.com](https://link.zhihu.com/?target=https%3A//code.visualstudio.com/docs/cpp/cpp-debug)



编辑于 2019-11-27

